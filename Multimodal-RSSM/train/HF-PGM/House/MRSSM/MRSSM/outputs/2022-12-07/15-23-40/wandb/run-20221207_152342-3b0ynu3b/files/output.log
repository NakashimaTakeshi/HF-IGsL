
load dataset:  40%|██████████████████████▍                                 | 4/10 [00:01<00:02,  2.63it/s]
using cuda:1
Initialize training environment and experience replay memory
load dataset from /home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../dataset/HF-PGM/MobileRobot_with_Image_Pose/MobileRobotImage_20221127/train

load dataset:  90%|██████████████████████████████████████████████████▍     | 9/10 [00:03<00:00,  2.77it/s]
set color augment params
calc pca from torch.Size([287, 3, 258, 258]) data
load dataset from /home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../dataset/HF-PGM/MobileRobot_with_Image_Pose/MobileRobotImage_20221127/validation
load dataset: 100%|███████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.74it/s]
load dataset:   0%|                                                                 | 0/3 [00:00<?, ?it/s]
set color augment params
calc pca from torch.Size([87, 3, 258, 258]) data
Initialise model parameters randomly
load dataset: 100%|█████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  3.22it/s]
/home/docker/.pyenv/versions/3.8.0/lib/python3.8/site-packages/torch/optim/adam.py:90: UserWarning: optimizer contains a parameter group with duplicate parameters; in future, this will cause an error; see github.com/pytorch/pytorch/issues/40967 for more information
  super(Adam, self).__init__(params, defaults)
train:   0%|                                                                     | 0/8000 [00:02<?, ?it/s]
Error executing job with overrides: ['main.experiment_name=debag_NaN']
Traceback (most recent call last):
  File "main.py", line 45, in main
    run(_cfg)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/MRSSM/train.py", line 76, in run
    train(cfg, cwd, results_dir, device)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/MRSSM/train.py", line 61, in train
    model.optimize(D)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/base/base.py", line 416, in optimize
    self.optimize_loss(observations_target, actions, rewards, nonterminals, states, self.itr_optim, observations_contrastive)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/base/base.py", line 391, in optimize_loss
    model_loss, loss_info = self._get_model_loss(observations_target, actions, rewards, nonterminals, states, observations_contrastive)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/base/base.py", line 352, in _get_model_loss
    observations_loss, reward_loss, kl_loss, contrastive_loss = self._calc_loss(observations_target, actions, rewards, nonterminals, states, observations_contrastive)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/base/base.py", line 283, in _calc_loss
    observations_loss = self._calc_observations_loss(observations_target, beliefs, posterior_states)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../algos/MRSSM/base/base.py", line 473, in _calc_observations_loss
    mse = self.observation_model.get_mse(h_t=beliefs, s_t=posterior_states, o_t=observations_target)
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../utils/models/observation_model.py", line 428, in get_mse
    mse = self.observation_models[name].get_mse(h_t, s_t, o_t[name])
  File "/home/docker/sharespace/Multimodal-RSSM/train/HF-PGM/House/MRSSM/MRSSM/../../../../../utils/models/observation_model.py", line 66, in get_mse
    print("loc:",loc_and_scale['loc'])
UnboundLocalError: local variable 'loc_and_scale' referenced before assignment
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
h_t: tensor([[[ 0.1208,  0.0648, -0.0822,  ...,  0.1041, -0.0634, -0.0336],
         [-0.0135,  0.0250, -0.0219,  ...,  0.0498, -0.2148, -0.0364],
         [-0.0795,  0.0571,  0.1062,  ..., -0.0759, -0.0978,  0.0759],
         ...,
         [ 0.0170,  0.0461,  0.0527,  ..., -0.0135,  0.0092,  0.0034],
         [ 0.0326,  0.0392, -0.0190,  ..., -0.0066, -0.0768,  0.0045],
         [ 0.0042,  0.0654,  0.0576,  ...,  0.0323,  0.0104, -0.0149]],
        [[ 0.1136,  0.1107, -0.1394,  ...,  0.1023, -0.1368,  0.0483],
         [-0.1224,  0.0842, -0.0178,  ..., -0.0087, -0.3813, -0.0460],
         [-0.1017,  0.1019,  0.1294,  ..., -0.1548, -0.2003,  0.1139],
         ...,
         [-0.0234,  0.1267,  0.1331,  ..., -0.0113, -0.0323,  0.0530],
         [-0.0027,  0.0430,  0.0168,  ..., -0.1017, -0.2332,  0.0601],
         [-0.0528,  0.1387,  0.0281,  ...,  0.1047, -0.0583,  0.0086]],
        [[ 0.1617,  0.1807, -0.0350,  ...,  0.1609, -0.1901, -0.1238],
         [-0.1150,  0.0978, -0.0881,  ..., -0.0325, -0.4380,  0.0779],
         [-0.1827,  0.0428,  0.2996,  ..., -0.2017, -0.2820,  0.1143],
         ...,
         [ 0.0685,  0.3062,  0.0847,  ...,  0.0971, -0.1467,  0.1807],
         [ 0.0389,  0.1077,  0.0054,  ..., -0.0939, -0.1965,  0.0814],
         [-0.0448,  0.2542,  0.1279,  ...,  0.0618, -0.1123,  0.2075]],
        ...,
        [[ 0.3655,  0.2045, -0.1180,  ...,  0.1741, -0.1582,  0.0839],
         [-0.0770,  0.2480, -0.0546,  ..., -0.0070, -0.5410,  0.0111],
         [-0.1633,  0.3757,  0.3523,  ..., -0.3220, -0.4114,  0.2935],
         ...,
         [-0.1364,  0.0699,  0.1147,  ..., -0.0219,  0.0133,  0.1682],
         [ 0.2314,  0.1884,  0.1119,  ...,  0.0179, -0.3032,  0.0112],
         [-0.1285,  0.2026,  0.1405,  ...,  0.1840, -0.0481, -0.1198]],
        [[ 0.2131,  0.1033, -0.1329,  ...,  0.1522, -0.0980, -0.0154],
         [ 0.0771,  0.1761, -0.1141,  ...,  0.0158, -0.5103, -0.0858],
         [-0.1642,  0.1383,  0.3782,  ..., -0.1405, -0.1898,  0.2661],
         ...,
         [-0.1103,  0.0390,  0.0988,  ..., -0.0057, -0.0082,  0.1285],
         [ 0.2177,  0.0611,  0.1438,  ..., -0.0355, -0.2280,  0.0748],
         [-0.1866,  0.1858,  0.0954,  ...,  0.1099, -0.1003, -0.0124]],
        [[ 0.2289,  0.2195, -0.1813,  ...,  0.1373, -0.1829, -0.0583],
         [-0.0909,  0.1401, -0.1017,  ...,  0.2020, -0.5522,  0.0252],
         [-0.3743,  0.2219,  0.3989,  ..., -0.2412, -0.3169,  0.1814],
         ...,
         [-0.0513,  0.1086,  0.1226,  ...,  0.0386, -0.0152, -0.0779],
         [ 0.0788,  0.1664,  0.1000,  ..., -0.0763, -0.2893, -0.0728],
         [-0.0458,  0.1591,  0.1935,  ...,  0.2449,  0.0230, -0.2140]]],
       device='cuda:1', dtype=torch.float16, grad_fn=<StackBackward0>)
s_t: tensor([[[-0.1170,  0.0980,  0.9572,  ...,  1.4025, -0.4224, -0.8967],
         [ 1.3077, -1.2016, -0.4830,  ...,  0.7734,  1.7479, -0.9966],
         [ 1.1466,  0.0702, -0.2582,  ..., -0.2563,  0.2101, -0.8824],
         ...,
         [-0.9692,  0.2243, -0.0549,  ..., -0.0794, -0.4761, -1.2450],
         [-0.2003, -0.7827,  0.6516,  ...,  0.0610,  1.0083, -1.9154],
         [ 0.5482,  0.5293,  0.2437,  ...,  0.7016, -0.0283,  0.4349]],
        [[ 0.0315, -0.2095, -1.3049,  ...,  0.2494, -0.0477,  0.1458],
         [-0.4607,  0.1444, -0.1225,  ...,  1.2425,  0.2416, -1.5291],
         [-0.0032, -1.5634, -0.3503,  ...,  0.3968,  0.7806, -1.2116],
         ...,
         [ 0.3141, -0.0364, -0.8578,  ...,  2.8526,  0.3948,  0.8128],
         [ 0.5315,  1.1286,  1.5192,  ...,  0.0095, -0.1674, -0.3267],
         [-0.6107,  0.2560,  0.5781,  ...,  0.6037,  1.9726, -1.4131]],
        [[ 0.7700,  0.6284, -0.4659,  ...,  0.0955,  1.2484, -0.5694],
         [ 1.0608, -1.3920,  1.6962,  ..., -0.2217,  0.8445,  0.0674],
         [ 0.8260, -0.5093,  0.6339,  ..., -0.6102, -0.1791, -2.8725],
         ...,
         [ 0.1829,  0.6827,  0.9230,  ..., -0.1765,  0.1643,  1.1352],
         [-0.1127,  0.8748, -0.4617,  ..., -1.7953,  0.2053, -0.9016],
         [-1.0139, -0.5330,  0.0855,  ...,  0.7760, -1.2560, -0.9690]],
        ...,
        [[-0.0128, -0.9557, -1.4329,  ..., -0.9977, -0.3155, -0.2401],
         [ 0.1414,  0.6903,  0.8277,  ...,  0.4169,  0.7933, -0.2025],
         [ 0.0531,  1.0698,  0.3868,  ..., -0.4548,  0.9763, -0.1263],
         ...,
         [-0.0911, -0.3274,  0.6947,  ..., -1.6531, -0.0137, -0.5332],
         [-0.1063, -0.0583,  0.2669,  ..., -0.3729,  1.2360, -0.9663],
         [-0.9261, -0.8039, -0.3887,  ...,  0.2992,  1.3398, -0.0293]],
        [[ 0.4798, -0.1748, -0.5319,  ...,  1.4792, -0.8731,  0.1797],
         [-0.7050, -0.5739,  1.4696,  ..., -1.0653, -0.7222,  1.1974],
         [-0.4618,  2.0319, -0.4767,  ..., -0.6010, -0.9667,  0.0276],
         ...,
         [-1.3311,  0.3136,  0.2922,  ...,  0.1460,  0.3845,  0.2097],
         [-1.7417,  1.3423,  0.1556,  ...,  0.3539, -0.1832,  1.2357],
         [-0.5583, -0.1797, -1.3574,  ...,  0.1710,  0.8616,  1.0894]],
        [[ 1.2038, -1.1296,  0.7079,  ..., -0.8720, -1.1674,  1.0329],
         [ 0.7617,  1.6114,  0.1842,  ...,  0.2581,  0.1540, -0.5811],
         [-0.4278,  1.4444, -0.0191,  ..., -0.3247, -1.4807, -0.7785],
         ...,
         [-0.6002,  0.5747, -1.0337,  ...,  0.8394,  0.9987, -0.6155],
         [-0.6320, -0.1299,  0.5858,  ...,  0.7689, -0.4148, -1.0242],
         [ 0.4821, -0.0774, -0.1645,  ...,  0.8875,  0.7707,  0.6756]]],
       device='cuda:1', grad_fn=<StackBackward0>)